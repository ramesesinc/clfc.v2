<workunit>
    <invokers>
        <invoker folderid="/home/business/business_application" caption="Retire"  action="start" target="window"  role="BUSINESSINFO" index="52"/>
    </invokers>
    
    <code>
         <![CDATA[    
        import com.rameses.rcp.annotations.*
        import com.rameses.rcp.common.*
        import com.rameses.osiris2.client.*
        import com.rameses.osiris2.common.*
        import java.rmi.server.*;
        
        public class RetireBusinessApplication extends PageFlowController {
        
            @Script("BusinessSearchUtil")
            def searchList;
        
            @Script("BusinessApplicationUtil")
            def application;
            
            @Script("BusinessAddressUtil")
            def address;
            
            @Script("BusinessRequirementUtil")
            def requirement;
            
            @Script("BusinessLobUtil")
            def lob;

            @Script("BusinessInfoUtil")
            def appinfo;

            @FormTitle
            def title = "Retire Business";
            
            def entity;
            
            def message = "Please review the current business to be retired.";
             
            void open() {
                application.init( [businessid:searchList.selectedItem.objid, apptype: 'RETIRE'] );
                lob.reset();
                appinfo.reset();
            }
            
            void saveCreate() {
                application.save();
                MsgBox.alert('Application sent for assessment!'); 
            }
            
        }
        ]]>
    </code>    
    
    <pageflow>
        
        <start>
            <transition to="search" name="create" />
        </start>
        
        <page name="search" title="Search Business Name (Retire)">
            <transition to="view-info" caption="Next" name="next" mnemonic="N" immediate="false" action="open"/>
        </page>
        
        <page name="view-info" title="Confirm Retirement">
            <transition to="end" caption="Next" name="end" mnemonic="N"  
                confirm="Please check if this is the correct application. This will be submitted for assesment. Proceed?"
                action="saveCreate"/>
        </page>
        
        
        <end/>
    </pageflow>
    
    <pages>
        <page name="search" template="com.rameses.gov.etracs.bpls.view.SearchBusinessPage"/>
        <page name="view-info" template="com.rameses.gov.etracs.bpls.view.EditLobPage"/>
    </pages>
    
    
</workunit>