import com.rameses.rcp.annotations.*
import com.rameses.rcp.common.*
import com.rameses.osiris2.client.*
import com.rameses.osiris2.common.*
import java.rmi.server.*;
import com.rameses.util.*;

public class BusinessCaptureSearchUtil {

    @Service("BusinessCaptureService")
    def service;

    @Caller
    def caller;

    def query = [:];
    boolean searching = false;
    def selectedItem;
    
    def listModel = [
        getRows : { return 25; },
        fetchList: { o->
            if(!query) return [];
            if(!query.tradename && !query.ownername) return [];
            if(!o) o = [:];
            o.putAll(query);
            return service.search( o );
        }
    ] as PageListModel;

    void search() {
        searching = true;
        listModel.doSearch();
    }

    void reset() {
        searching = false;
        query = [:];
        listModel.doSearch();
    }

    void openEntry() {
        if(!selectedItem) 
            throw new Exception("Please select an item");
        selectedItem.source =  query.source;   
        caller.entity = service.getInfo(selectedItem);
        caller.entity.txnmode = 'CAPTURE'
        caller.entity.source = query.source;
    }

    def getAssessorList() {
        return service.getAssessorList();
    }

    def getApproverList() {
        return service.getApproverList();
    }
    

}